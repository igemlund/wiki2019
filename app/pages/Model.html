<!-- index.html -->
{% extends "layout.html" %}
{% block content %} 
{% include "partials/header.nunjucks" %}
<h1 id="title" class="js-toc-ignore">Mathematical Models</h1>
<div id="body">
<h1 class="js-toc-ignore">STACC</h1>
    <p>We here present our machine learning algorithm STAAC. STAAC is a combination of two neural networks and a tree-based model that when integrated into a genetic algorithm can generate peptides with different antimicrobial properties by classifying them into the categories antifungal (AFP), non-antifungal antimicrobial (NoAFP-AMP), and non-antimicrobial (NoAMP). The categories are illustrated in the Venn diagram below:
        </p>
<br>
<p>The objective of STAAC is to generate new, previously unseen peptides that would suit our project of producing anti-oomycete peptides in bacteria. This means that the peptides should have strong antifungal and therefore anti-oomycete, properties, while at the same time having weak antibacterial properties. STAAC is therefore trained to maximize the harmonic mean (HM) of the AFP classification precision and the NoAFP-AMP classification recall. Overall, STAAC can classify unseen peptides with an accuracy of 88 %, AFPs with a precision of 88 %, and NoAFP-AMPs with a recall of 65 %. We would like to stress that there are models out there with much better accuracy and precision if one would like to answer the binary question: “Is this peptide antifungal?”. Indeed, when we converted our model to answer this binary question, we received a precision of 93.5 % and an overall accuracy of 94 %.</p>

<h2 id="js-toc-ignore">Theory</h2>
<p>The STAAC model is a combination of a Random Forest Classifier and two neural networks, combined using a Support Vector Machine. </p>
<br>
<h3 id="js-toc-ignore">Random Forest Classifiers:</h3>
<p>The Random Forest Classifier (RFC) is a so-called ensemble learning algorithm, meaning it consists of several preliminary algorithms merged into one. In the case of the RFCs, these preliminary algorithms are decision tree classifiers. The decision tree classifier is a binary tree where each node is a binary condition (ex. Is peptide length > 20 peptides) and each leaf is a predicted label. A prediction is generated by passing the features through the tree, from the root to the leaves by answering these binary conditions. The RFC supplies a randomly chosen subset of the training features to each of its decision trees and then comes up with a prediction based on the majority vote of the individual trees. This randomized behavior of the RFC does very well in tackling the otherwise great issue of overfitting that comes with a simple decision tree. A more in-depth explanation of the RFC can be found <a href="https://en.wikipedia.org/wiki/Random_forest">here</a>.</p>
<h3 id="js-toc-ignore">Neural Networks:</h3>
<p>Neural networks are becoming increasingly popular in bioinformatics. This is due to their ability to handle a huge number of features without overfitting. They are also very capable of finding non-linear patterns in the data. The input is here passed through layers of nodes by edges connecting one layer to the next. Each edge has a weight and each node has an activation function. This means that the number of fitted parameters often becomes very large (about n_{nodes}^2 * n_{layers}) and it is seldom possible for a human to understand the operations performed by the network. This leads to the obvious downside with neural networks; it’s often very hard to figure out what kind of pattern the network finds. There are several great resources to further deepen your understanding of neural networks,<a href="https://en.wikipedia.org/wiki/Artificial_neural_network">for example</a>.  </p>
<h3 id="js-toc-ignore">SVM:</h3>
 <p>The Support Vector Machine is a common supervised machine learning algorithm when dealing with classification problems. The algorithm works by constructing hyperplanes, maximizing the margin between the data points of each classification label closest to one another, also called the support vectors. This is mainly done by constructing a linear plane or, when the data is nonlinear, by increasing the dimensions of the data. A great explanation can be found on <a href="(https://www.datacamp.com/community/tutorials/svm-classification-scikit-learn-python#svm">DataCamp</a>.</p>
<h3 id="js-toc-ignore">Metrics:</h3>
 <p>In our case, we had an issue with an unbalanced data set. While having about 8000 peptides labelled as “non-antimicrobial”, we had about 3000 AMPs and only about 500 labelled as “non-antifungal - antimicrobial”. If one would use the overall accuracy of the model to evaluate the performance, then an algorithm classifying everything as NoAMP would get a 70 % accuracy. If it manages to correctly differentiate between AFPs and NoAFPs but completely ignores NoAFPAMPs, we will get an overall accuracy of 95 %! To overcome this, it’s often good practice to use precision, recall, or f1-score instead, all of which can be defined through the confusion matrix:</p>
<button type="button" class="collapsible">&darr; Table 1: Confusion matrix in binary classification: </button>
<table>
  <tr>
    <th>      </th>
    <th>True 1</th>
    <th>True 0</th>
  </tr>
  <tr>
      <td><b><i>Predicted 1</i></b></td>
      <td>True positive (TP).</td>
      <td>False-positive (FP).</td>
  </tr>
  <tr>
      <td><b><i>Predicted 0</i></b></td>
      <td>False-negative (FN).</td>
      <td>True negative (TN).</td>
  </tr>
</table>





To better understand this text it’s recommended to read the <a href="/Team:Lund/Description">project description</a> before continuing.
</p>
<h2 id="Modeling-growth-and-ion-accumulation in a singel colony">Bioaccumulation in a Bacteria Colony</h2>

<p>
    To model the growth, protein production and ion accumulation of a single colony, a system of seven differential equations was devised. Equation (1) and (2) describes the colony as a whole and the concentration of ions in its growth medium, whereas equation (3) - (7) describes the changes inside the average individual cell. A graphical representation of the equation can be found in animation 1. Short descriptions of the time-dependent variables can be found in table 1. Descriptions and approximate values of the parameters can be found in table 2. The initial parameters for the initial conditions can be found in table 3.
</p>
<br>
<p><b>Equation (1)</b> describes the precision in the binary confusion matrix .</p>
<br>
<p><b>Equation (2)</b> describes the recall in the binary confusion matrix. </p>
<br>
<b>Equation (3)</b> describes the f1 score in the binary confusion matrix. </p>
<br>
<b>Equation (4)</b> describes the precision of A in the multilabel confusion matrix.  </p>
<br>
<b>Equation (5)</b> describes the Recall of A in the multilabel confusion matrix. </p>
<br>
<b>Equation (6)</b> defines the harmonic mean of the AFP precision (here A) and the NoAFPAMP recall (here B). The values for the NoAMP class are denoted by C. See the multilabel confusion matrix for reference. </p>
<br>


<p class ="math">
<dtex> Precision =\frac{TP}{TP + FP}</dtex>
<dtex>Recall  =\frac{TP}{TP + FN}</dtex> 
<dtex>F1Score=\frac{PrecisionxRecall}{Precision+Recall}</dtex>
<dtex>Precision_{A} = \Frac{Aa}{Aa+Ba+Ca} </dtex>
<dtex>Recall_{A} =\ Frac{Aa}{Aa+Ab+Ac}</dtex> 
<dtex>HM=\frac{2}{Precision_{A}^{-1} + Recall_{B}^{-1}} = \frac{2Aa x Bb}{2Aa x Bb + Aa(Bc+Ba)+Bc(Ca+Ba)} = (1+ \frac{Ba + Bc}{Bb} + \frac{Ba + Ca}{Aa})^{-1}  </dtex>
</p>

<button type="button" class="collapsible">&darr; Table 1: Confusion matrix in binary classification:</button>
<table>
  <tr>
    <th>Varible</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><i>N</i></td>
    <td>The total number of living cells in the growth medium.</td>
  </tr>
  <tr>
    <td><i>G</i></td>
    <td>The total number of ions in the growth medium.</td>
  </tr>
  <tr>
      <td><i>mRNA</i></td>
      <td>The number of mRNAs coding for the ion-transport protein and the ions accumulation protein.</td>
  </tr>
  <tr>
      <td><i>TP</i></td>
      <td>The number of transport proteins expressed in a single cell.</td>
  </tr>
  <tr>
      <td><i>AP<sub>free</sub></i></td>
      <td>The number of free accumulation protein expressed inside a single cell.</td>
  </tr>
  <tr>
      <td><i>AP<sub>occupied</sub></i></td>
      <td>The number of accumulation protein expressed a single cell, that are bound to an ion.</td>
  </tr>
  <tr>
      <td><i>C</i></td>
      <td>The number of free ions inside the cytoplasm of a single cell.</td>
  </tr>
</table>
<p></p>
<br>
<button type="button" class="collapsible">&darr; Table 2: Confusion matrix in Multilabel classification</button>
<table>
  <tr>
    <th>      </th>
    <th>True A</th>
    <th>True B</th>
    <th>True C</th>
  </tr>
  <tr>
      <td><b>Predicted a</b></td>
      <td>Aa</td>
      <td>Ba</td>
      <td>Ca</td>
  </tr>
  <tr>
    <td><b>Predicted b</b></td>
    <td>Ab</td>
    <td>Bb</td>
    <td>Cb</td>
  </tr>
  <tr>
    <td><b>Predicted c</b></td>
    <td>Ca</td>
    <td>Cb</td>
    <td>Cc</td>
  </tr>
</table>

<p></p>

<br>

<h4 class="references js-toc-ignore" >References:</h4>
<ul class="references">
    <li>[1] Stewart, James; Clegg, Daniel (2012). Brief Applied Calculus. (p. 358)</li>
    <li>[2] Jaroslawiecka, A., & Piotrowska-Seget, Z. (2013). Lead resistance in micro-organisms. Microbiology, 160(Pt_1), 12–25. doi: 10.1099/mic.0.070284-0</li>
    <li>[3] Lodish, H. (2002). Molecular cell biology. New York, NY: Freeman. (p. 249)</li>
    <li>[4] Zhan, Zhang, and Chung. Adaptive particle swarm optimization, IEEE Transactions on Systems, Man, and Cybernetics, Part B: CyberneticsVolume 39, Issue 6, 2009, Pages 1362-1381 (2009)</li>
    <li>[5] Akman, D., Akman, O., & Schaefer, E. (2018). Parameter Estimation in Ordinary Differential Equations Modeling via Particle Swarm Optimization. Journal of Applied Mathematics, 2018, 1–9. doi: 10.1155/2018/9160793</li>
    <li>[6] Zhang, X. Y., Trame, M. N., Lesko, L. J., & Schmidt, S. (2015). Sobol Sensitivity Analysis: A Tool to Guide the Development and Evaluation of Systems Pharmacology Models. CPT: pharmacometrics & systems pharmacology, 4(2), 69–79. doi:10.1002/psp4.</li>6
    <li>[7]  Dede, Eric, et al. "Physiologically-based pharmacokinetic and toxicokinetic models for estimating human exposure to five toxic elements through oral ingestion." Environmental toxicology and pharmacology 57 (2018): 104-114</li>
    <li>[8] El-Masri, H. A and Kenyon, E. M (2008). Development of a human physiologically based pharmacokinetic (PBPK) model for inorganic arsenic and its mono- and di-methylated metabolites. Journal of Pharmacokinetics and Pharmacodynamics, 35(1), 31–68. doi: 10.1007/s10928-007-9075-z</li>
    <li>[9] Libretexts. (2019, June 5). The Rate Law. Retrieved from https://chem.libretexts.org/Bookshelves/Physical_and_Theoretical_Chemistry_Textbook_Maps/Supplemental_Modules_(Physical_and_Theoretical_Chemistry)/Kinetics/Rate_Laws/The_Rate_Law</li>
    <li>[10] O’Flaherty, E. J. (1991). Physiologically based models for bone-seeking elements. Toxicology and Applied Pharmacology, 111(2), 313–331. doi: 10.1016/0041-008x(91)90033-b</li>
    <li>[11] O'Flaherty E. J. (1998). A physiologically based kinetic model for lead in children and adults. Environmental health perspectives, 106 Suppl 6(Suppl 6), 1495–1503. doi:10.1289/ehp.98106s61495</li>
    <li>[12] Fleming, D. E., Chettle, D. R., Webber, C. E., and O’Flaherty, E. J. (1999). The OFlaherty Model of Lead Kinetics: An Evaluation Using Data from a Lead Smelter Population. Toxicology and Applied Pharmacology, 161(1), 100–109. doi: 10.1006/taap.1999.8790</li>
    <li>[13] Center for Food Safety and Applied Nutrition. (n.d.). Lead in Food, Foodwares, and Dietary Supplements. Retrieved October 19, 2019, from https://www.fda.gov/food/metals/lead-food-foodwares-and-dietary-supplements.</li>
    <li>[14] Sharma, M., Maheshwari, M., & Morisawa, S. (2005). Dietary and Inhalation Intake of Lead and Estimation of Blood Lead Levels in Adults and Children in Kanpur, India. Risk Analysis, 25(6), 1573–1588. doi: 10.1111/j.1539-6924.2005.00683.x</li>
    <li>[15] Agency for Toxic Substances and Disease. (2007, August 1). Toxic Substances Portal - Arsenic. Retrieved October 19, 2019, from https://www.atsdr.cdc.gov/phs/phs.asp?id=18&tid=3.</li>
    <li>[16] https://bionumbers.hms.harvard.edu/bionumber.aspx?id=111997&ver=5</li>
</ul>
</div>
{% include "partials/footer.nunjucks" %}
</div>

{% endblock %}
